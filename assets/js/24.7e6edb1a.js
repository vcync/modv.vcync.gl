(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{208:function(t,e,a){"use strict";a.r(e);var s=a(6),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"writing-a-shader-module"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#writing-a-shader-module"}},[t._v("#")]),t._v(" Writing a Shader Module")]),t._v(" "),a("p",[t._v("We're going to write a Module which works with the built-in "),a("code",[t._v("shader")]),t._v(" Renderer.")]),t._v(" "),a("p",[t._v("To follow this guide, we'd recommend having some experience with:")]),t._v(" "),a("ul",[a("li",[t._v("JavaScript (ES6+)")]),t._v(" "),a("li",[t._v("GLSL\n"),a("ul",[a("li",[t._v("if you don't already have experience with GLSL then we recommend ???")])])])]),t._v(" "),a("p",[t._v("We'll be stealing ðŸ˜¬ "),a("a",{attrs:{href:"https://github.com/AVGP/shaderpad/blob/gh-pages/interesting_shaders.md#spherical-with-concentric-circles-blend",target:"_blank",rel:"noopener noreferrer"}},[t._v("a shader"),a("OutboundLink")],1),t._v(" from "),a("a",{attrs:{href:"https://twitter.com/g33konaut",target:"_blank",rel:"noopener noreferrer"}},[t._v("Martin Splitt"),a("OutboundLink")],1),t._v("'s "),a("a",{attrs:{href:"https://github.com/AVGP/shaderpad",target:"_blank",rel:"noopener noreferrer"}},[t._v("awesome shaderpad"),a("OutboundLink")],1),t._v(" - so you won't need a bunch of GLSL experience to follow along.")]),t._v(" "),a("h2",{attrs:{id:"_1-create-a-new-file"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-create-a-new-file"}},[t._v("#")]),t._v(" 1. Create a new file")]),t._v(" "),a("p",[t._v("Save a blank JavaScript file in the "),a("RouterLink",{attrs:{to:"/guide/mediaManager.html#media-folder"}},[t._v("Media Manager's media directory")]),t._v(". This will need to be placed in a "),a("code",[t._v("module")]),t._v(" folder within a Project folder. e.g. "),a("code",[t._v("[media path]/[project]/module")]),t._v(".")],1),t._v(" "),a("p",[t._v("By saving your Module here the Media Manager will compile your code and send it to modV on every file save. If you've placed your Module within a Layer already, you'll need to remove it from the Layer and drag your Module in again from the Gallery to use the updated Module.")]),t._v(" "),a("h2",{attrs:{id:"_2-export-an-object"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-export-an-object"}},[t._v("#")]),t._v(" 2. Export an Object")]),t._v(" "),a("p",[t._v("Let's get started by exporting an Object. modV Modules are written out as a plain Object.")]),t._v(" "),a("div",{staticClass:"language-JavaScript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"_3-set-up-the-meta"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-set-up-the-meta"}},[t._v("#")]),t._v(" 3. Set up the Meta")]),t._v(" "),a("p",[t._v("Next up, we'll need to describe our Module with a meta Object block.\nLet's define the Module type as "),a("code",[t._v("shader")]),t._v(" and give our Module a name.")]),t._v(" "),a("div",{staticClass:"language-JavaScript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  meta"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this tells modV our Module should be used with the shader renderer")]),t._v("\n    type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'shader'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// our Module's name")]),t._v("\n    name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Spherical'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"_4-define-our-shaders"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-define-our-shaders"}},[t._v("#")]),t._v(" 4. Define our Shaders")]),t._v(" "),a("p",[t._v("In "),a("code",[t._v("shader")]),t._v(" type Modules, there are two properties on the Module body to define the Shaders we want to use:")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("fragmentShader")])]),t._v(" "),a("li",[a("code",[t._v("vertexShader")])])]),t._v(" "),a("p",[t._v("Both are optional and the "),a("code",[t._v("shader")]),t._v(" Renderer automatically detects whether we're using "),a("code",[t._v("#version 300 es")]),t._v(" or not.\nBoth of these variables accept Strings only.")]),t._v(" "),a("p",[t._v("If you have a larger shader or require syntax highlighting, you may import your shaders using:")]),t._v(" "),a("div",{staticClass:"language-JavaScript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" fragmentShader "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'circles.frag'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" vertexShader "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'circles.vert'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("We'll only be using the "),a("code",[t._v("fragmentShader")]),t._v(" property in this guide:")]),t._v(" "),a("div",{staticClass:"language-JavaScript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// meta: { ... },")]),t._v("\n  \n  fragmentShader"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\n    precision mediump float;\n    varying mediump vec2 uv;\n\n    uniform float uA;\n    uniform sampler2D u_modVCanvas;\n\n    void main(void) {\n      vec2 p = -1.0 + 2.0 * uv.xy;\n      float r = sqrt(dot(p, p));\n\n      float f = sqrt(1.0 - (r * r));\n      bool toggle = mod(r, 0.1) > 0.05 ? true : false;\n      if (f > 0.0 && toggle) \n        gl_FragColor = vec4(vec3(f), 1.0) * texture2D(u_modVCanvas, vec2(uv.x, uv.y));\n      else \n        gl_FragColor = vec4(uv.x, uv.y, 1.0, 1.0);\n    }\n  ")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"_5-props-and-uniforms"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-props-and-uniforms"}},[t._v("#")]),t._v(" 5. Props and Uniforms")]),t._v(" "),a("h3",{attrs:{id:"_5-1-uniforms"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-uniforms"}},[t._v("#")]),t._v(" 5.1 uniforms")]),t._v(" "),a("p",[t._v("The "),a("code",[t._v("shader")]),t._v(" Renderer defines the following Uniforms for you to consume within your Shader:")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("name")]),t._v(" "),a("th",[t._v("type")]),t._v(" "),a("th",[t._v("info")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("code",[t._v("u_modVCanvas")]),t._v(", "),a("code",[t._v("iChannel0")]),t._v(", "),a("code",[t._v("iChannel1")]),t._v(", "),a("code",[t._v("iChannel2")]),t._v(", "),a("code",[t._v("iChannel3")])]),t._v(" "),a("td",[a("code",[t._v("texture2D")])]),t._v(" "),a("td",[t._v("The incoming frame")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("u_delta")]),t._v(", "),a("code",[t._v("iTime")]),t._v(", "),a("code",[t._v("iGlobalTime")])]),t._v(" "),a("td",[a("code",[t._v("float")])]),t._v(" "),a("td",[t._v("Time in milliseconds")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("u_time")])]),t._v(" "),a("td",[a("code",[t._v("float")])]),t._v(" "),a("td",[t._v("Time in seconds")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("iFrame")])]),t._v(" "),a("td",[a("code",[t._v("float")])]),t._v(" "),a("td",[t._v("Frame count since modV's drawloop started")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("iResolution")])]),t._v(" "),a("td",[a("code",[t._v("vec3")])]),t._v(" "),a("td",[t._v("The "),a("strong",[t._v("width")]),t._v(", "),a("strong",[t._v("height")]),t._v(" and "),a("strong",[t._v("pixel density")]),t._v(" of the largest Output Window")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("iMouse")])]),t._v(" "),a("td",[a("code",[t._v("vec4")])]),t._v(" "),a("td",[a("code",[t._v("[0.0, 0.0, 0.0, 0.0]")]),t._v(" "),a("strong",[t._v("@todo make this an actual control")])])])])]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("Shadertoy compatibility")]),t._v(" "),a("p",[t._v("The "),a("code",[t._v("shader")]),t._v(" Renderer attempts to provide basic Shadertoy Uniform compatibility."),a("br"),t._v(" "),a("strong",[t._v("Currently it does not support passes/buffers or Audio shaders.")])])]),t._v(" "),a("h3",{attrs:{id:"_5-2-defining-props"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-defining-props"}},[t._v("#")]),t._v(" 5.2 Defining props")]),t._v(" "),a("p",[t._v("With a "),a("code",[t._v("shader")]),t._v(" Module, the props should match the uniforms in your shader.")]),t._v(" "),a("p",[t._v("Our shader above has a uniform named "),a("code",[t._v("uA")]),t._v(" so we'll define the same in our props:")]),t._v(" "),a("div",{staticClass:"language-JavaScript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("props"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  uA"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'float'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    min"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    max"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])])]),a("h2",{attrs:{id:"_6-putting-everything-together"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-putting-everything-together"}},[t._v("#")]),t._v(" 6. Putting everything together")]),t._v(" "),a("p",[t._v("The following code puts together everything from above:")]),t._v(" "),a("div",{staticClass:"language-JavaScript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  meta"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'shader'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Spherical'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  \n  props"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    uA"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'float'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      min"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      max"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\n  fragmentShader"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\n    precision mediump float;\n    varying mediump vec2 uv;\n\n    uniform float uA;\n    uniform sampler2D u_modVCanvas;\n\n    void main(void) {\n      vec2 p = -1.0 + 2.0 * uv.xy;\n      float r = sqrt(dot(p, p));\n\n      float f = sqrt(1.0 - (r * r));\n      bool toggle = mod(r, 0.1) > 0.05 ? true : false;\n      if (f > 0.0 && toggle) \n        gl_FragColor = vec4(vec3(f), 1.0) * texture2D(u_modVCanvas, vec2(uv.x, uv.y));\n      else \n        gl_FragColor = vec4(uv.x, uv.y, 1.0, 1.0);\n    }\n  ")]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])}),[],!1,null,null,null);e.default=r.exports}}]);